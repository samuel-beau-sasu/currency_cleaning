-- definitions/marts/test_minimal.sqlx

config {
  type: "operations",
  schema: "bq_data_finance",
  description: "Test minimal avec opÃ©rations multiples"
}

js {
  const projectId = "financial-data-storage"; // Remplacez par votre vrai project ID
  const databaseId = "bq_data_finance";
  const indices = ["DJI", "SP500", "Nasdaq"];
}

${indices.map(item => `
CREATE OR REPLACE VIEW \`${projectId}.${databaseId}.test_${item}\` AS (
  SELECT '${item}' AS value
);`).join('\n')}
